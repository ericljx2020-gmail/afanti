extract_template = r"""
    ### 提取任务说明：

    从以下数学课的视频字幕中提取出所有的题目和老师对题目的详细讲解部分。请确保只提取明确标识为题目的内容和相应的讲解，并按如下格式输出：

    ### 注意事项：

    1. **过滤无关信息**：在提取过程中，请过滤掉与题目无关的信息，例如“同学们做好了吗？”、“请先按暂停键做完之后我们一起来对答案逐一分析”等等。

    2. **忽略定义问题**：请忽略定义类型的问题与解释，这些问题通常不需要详细解题过程。

    3. **忽略需要视觉图形的问题**：请忽略掉你认为需要视觉图形才可以解的题目，过滤掉包含类似于“表”、“图”、“样例”等字眼的题目。

    4. **确保题目信息完整**：请保证所有提取出的题目包含足够的信息，能够凭这些信息解题。一定不要提取出类似于只有“例一”或“这个问题”之类没有具体题干的题目。

    5. **避免不完整的问题**：忽略包含类似于以下字眼的问题，因为这些问题通常需要结合视觉图形才能解答：
        - “下面这题”
        - “以下选项”
        - “上面”
        - “图中”
        - “表中”
        - “这张图”
        - “如下图”

    6. **输出格式**：请按以下格式输出提取的内容：
        ### 原题一：
        （提取出的原题）

        ### 讲解一：
        （提取出的讲解）

    示例：
        ### 原题一：
        引力学校篮球赛中每一场都要分出胜负，每队胜一场得两分，负一场得一分。某队22场比赛中得到40分，那么这个队胜负场数分别为多少？

        ### 讲解一：
        设胜X场，负Y场。根据题意可以得到：
        \[ X + Y = 22 \]
        \[ 2X + Y = 40 \]

        这个实际问题能列一元一次方程组求解吗？设胜X场，则负场数为22减X。根据题意可得：
        \[ 2X + (22 - X) = 40 \]

"""

validator_template = r"""
    你是一个验证器，任务是验证从视频字幕中提取的题目和讲解是否完整并且逻辑一致。你的工作是检查每个提取的问题和对应的讲解是否完整，并且结构是否正确。以下是你应该使用的标准：

    1. **完整性**：
    - 每个问题应该包含理解和解决问题所需的所有信息。
    - 每个讲解应该提供完整且逻辑的分步骤解决方案。

    2. **逻辑一致性**：
    - 讲解中的步骤应该逻辑上相互衔接。
    - 讲解应正确解决所述问题并得出正确的解决方案。

    3. **问题和讲解的匹配**：
    - 问题和其讲解应直接对应。
    - 讲解提供的解决方案应解决所述问题。

    **验证步骤**：
    1. 仅浏览每个提取的原题，不看讲解内容。
    2. 验证问题陈述是否包含所有必要细节，如果题目部分需要依赖样例，或者图表等视觉，忽略此类问题。
    3. 输出所有完整的问题及其讲解。
    4. 请将对每一题进行验证的过程输出，如果最后认为当前题不符合要求，在最后输出"不符合要求"

    **输入**：
    一系列从视频字幕中提取的问题和讲解，格式如下：

    ### 原题一：
        （提取出的原题）

    ### 讲解一：
        （提取出的讲解）

    ### 分析过程一：
         (对该题的验证过程)
"""

generator_template = r"""
    你是一个验证器，任务是从已验证的问题和讲解中提取出符合要求的完整问题和讲解。你需要从给定的验证结果中识别出那些符合要求的题目，并输出它们。请按照以下步骤进行：

    1. 阅读每个验证结果，识别出验证过程和结果。
    2. 如果验证过程最后输出了"不符合要求"，则忽略该题目和讲解。
    3. 如果验证过程没有输出"不符合要求"，则将该题目和讲解提取出来。
    4. 输出所有符合要求的问题和讲解。

    **输入**：
    一系列验证后的问题和讲解，格式如下：

    ### 原题一：
    （提取出的原题）

    ### 讲解一：
    （提取出的讲解）
"""

extract_prompt = r"""
    请从以下数学题目中提取关键信息。请返回以下格式的信息：

    1. 数学领域和类型（如代数、几何、微积分、统计等）
    2. 核心概念和原理（列出题目所需要的数学概念，如比例、相似、函数性质等）
    3. 解题方法和策略（列出用到特定的解题技巧，如配方法、换元法、归纳法等）
    4. 问题背景和情境（指出题目问题情境，如工程问题、经济问题、自然现象解释）
    5. 变量数量（题目所用到变量的数量，一定不要输出变量具体是什么）
    6. 题目所属年级（列出这道题最可能出现在哪一年级的试卷上）

    示例题目：
    求解方程 2x + 3 = 7

    示例输出：
    1. 数学领域和类型: 代数
    2. 核心概念和原理: 方程
    3. 解题方法和策略: 移项
    4. 问题背景和情境: 无
    5. 变量数量: 1
    6. 题目所属年级: 4

    现在请处理以下题目：
    {problem}
"""